<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weatherly - Settings</title>
<link rel="stylesheet" href="stylesheet/global.css">
<link rel="stylesheet" href="stylesheet/settings.css">
</head>
<body>

<!-- Top Navigation -->
<header class="top-nav">
  <div class="logo">
    <span class="logo-icon">â˜ï¸</span>
    <h1 class="title">Weatherly</h1>
  </div>
  <nav class="nav-links">
    <a href="saved.html">Dashboard</a>
    <a href="search.html">Search</a>
    <a href="pastWeather.html">Past Weather</a>
    <a href="weatherAlerts.html">Alerts</a>
    <a href="settings.html" class="active">Settings</a>
    <a href="help.html">Help</a>
  </nav>
  <div class="user-section">
    <button onclick="window.location.href='profile.html'" class="profile-btn">Demo User</button>
    <button onclick="window.location.href='login.html'" class="logout-btn">Logout</button>
  </div>
</header>

<main class="main-container">

  <div class="section-header">
    <h2>Settings</h2>
    <p>Adjust your preferences for Weatherly alerts and interface.</p>
  </div>

  <div class="alerts-container">

    <!-- Account Card -->
    <div class="alert-card alert-info">
      <div class="alert-card-content">
        <div class="alert-icon alert-icon-info">ğŸ‘¤</div>
        <div class="alert-main">
          <div class="alert-header">
            <h3 class="alert-title">Account</h3>
          </div>
          <p class="alert-description">Username: Demo User</p>
          <button class="btn btn-primary" onclick="window.location.href='profile.html'">Edit Profile</button>
        </div>
      </div>
    </div>

    <!-- Units Card -->
    <div class="alert-card alert-info">
      <div class="alert-card-content">
        <div class="alert-icon alert-icon-info">ğŸŒ¡ï¸</div>
        <div class="alert-main">
          <div class="alert-header">
            <h3 class="alert-title">Units</h3>
          </div>
          <div class="settings-tags">
            <label><input type="radio" name="unit-temp" id="unit-f"> Fahrenheit (Â°F)</label>
            <label><input type="radio" name="unit-temp" id="unit-c"> Celsius (Â°C)</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Notifications Card -->
    <div class="alert-card alert-info">
      <div class="alert-card-content">
        <div class="alert-icon alert-icon-info">ğŸ””</div>
        <div class="alert-main">
          <div class="alert-header">
            <h3 class="alert-title">Notifications</h3>
          </div>
          <div class="settings-tags">
            <label><input type="checkbox" id="set-severe"> Severe Weather</label>
            <label><input type="checkbox" id="set-temp"> Temperature Alerts</label>
            <label><input type="checkbox" id="set-precip"> Precipitation Alerts</label>
            <label><input type="checkbox" id="set-air"> Air Quality Alerts</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Accessibility Card -->
    <div class="alert-card alert-info">
      <div class="alert-card-content">
        <div class="alert-icon alert-icon-info">â™¿</div>
        <div class="alert-main">
          <div class="alert-header">
            <h3 class="alert-title">Accessibility</h3>
          </div>
          <div class="settings-tags">
            <label><input type="checkbox" id="a11y-high-contrast"> High Contrast Mode</label>
            <label><input type="checkbox" id="a11y-large-text"> Large Text</label>
            <label><input type="checkbox" id="a11y-animations"> Reduce Motion</label>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="button-group">
    <button class="btn btn-primary" id="saveSettings">ğŸ’¾ Save</button>
    <button class="btn btn-outline" id="cancelSettings">âŒ Cancel</button>
  </div>

</main>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const body = document.body;
  const checkboxes = [
    "set-severe",
    "set-temp",
    "set-precip",
    "set-air",
    "a11y-high-contrast",
    "a11y-large-text",
    "a11y-animations"
  ];

  // Default settings (Fahrenheit, all accessibility off)
  const defaultPrefs = {
    unit: "F", // Fahrenheit default
    "set-severe": false,
    "set-temp": false,
    "set-precip": false,
    "set-air": false,
    "a11y-high-contrast": false,
    "a11y-large-text": false,
    "a11y-animations": false
  };

  // Load saved settings from localStorage
  let savedPrefs = JSON.parse(localStorage.getItem("userSettings"));

  // If nothing saved, use defaults and overwrite old localStorage
  if (!savedPrefs) {
    savedPrefs = defaultPrefs;
    localStorage.setItem("userSettings", JSON.stringify(savedPrefs));
  } else {
    // Make sure all keys exist for old storage
    Object.keys(defaultPrefs).forEach(key => {
      if (!(key in savedPrefs)) savedPrefs[key] = defaultPrefs[key];
    });
  }

  // Function to apply accessibility settings safely
  function applyAccessibility(settings) {
    body.classList.remove("large-text", "high-contrast", "reduce-motion");
    if (settings["a11y-large-text"] === true) body.classList.add("large-text");
    if (settings["a11y-high-contrast"] === true) body.classList.add("high-contrast");
    if (settings["a11y-animations"] === true) body.classList.add("reduce-motion");
  }

  // Initialize UI states
  if (savedPrefs.unit === "C") {
    document.getElementById("unit-c").checked = true;
    document.getElementById("unit-f").checked = false;
  } else {
    document.getElementById("unit-f").checked = true;
    document.getElementById("unit-c").checked = false;
  }

  checkboxes.forEach(id => {
    document.getElementById(id).checked = savedPrefs[id] === true;
  });

  applyAccessibility(savedPrefs);

  // Keep a copy for cancel
  let tempPrefs = JSON.parse(JSON.stringify(savedPrefs));

  // Save button
  document.getElementById("saveSettings").addEventListener("click", () => {
    const updated = {
      unit: document.getElementById("unit-c").checked ? "C" : "F"
    };
    checkboxes.forEach(id => {
      updated[id] = document.getElementById(id).checked === true;
    });
    localStorage.setItem("userSettings", JSON.stringify(updated));
    tempPrefs = JSON.parse(JSON.stringify(updated));
    applyAccessibility(updated);
    alert("Settings saved!");
  });

  // Cancel button
  document.getElementById("cancelSettings").addEventListener("click", () => {
    document.getElementById(tempPrefs.unit === "C" ? "unit-c" : "unit-f").checked = true;
    checkboxes.forEach(id => {
      document.getElementById(id).checked = tempPrefs[id] === true;
    });
    applyAccessibility(tempPrefs);
    alert("Changes canceled!");
  });
});
</script>


</body>
</html>

